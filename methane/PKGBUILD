# Maintainer: carstene1ns <url/mail: arch carsten-teibes de>
# Contributor: Dany Martineau <dany.luc.martineau at gmail.com>
# Contributor: Larryhaja  <larryhaja at gmail.com>

pkgname=methane
pkgver=1.5.1
pkgrel=4
pkgdesc="Help the Super Methane Brothers to capture baddies with your gas gun."
arch=('i686' 'x86_64')
url="http://methane.sourceforge.net"
license=('GPL')
depends=('clanlib-23')
source=("http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tgz"
        "$pkgname.png"
        "$pkgname.desktop"
        "$pkgname-clanlib23.patch"
        "$pkgname-nogl1.patch")
md5sums=('7e4258e326478678c2332388eab2ed14'
         'a9ec845554b4987c02723b87d308e573'
         'SKIP' 'SKIP' 'SKIP')
sha256sums=('ac1de7009e638c784b4d413b56a4387be94a31bd5fe3050db7b51e39ccfdd248'
            '6c56b025b058a954bd089850dc50f4f25b292da97bbba0d4315db4060152f1fe'
            'SKIP' 'SKIP' 'SKIP')

prepare() {
  cd $pkgname-$pkgver

  # clanlib related changes
  patch -Np1 < ../$pkgname-clanlib23.patch
  # remove opengl1 renderer
  patch -Np1 < ../$pkgname-nogl1.patch
}

build() {
  cd $pkgname-$pkgver

  # remove leftover build dir
  rm -rf build

  make
}

package() {
  cd $pkgname-$pkgver

  # install desktop entry
  install -Dm644 ../$pkgname.desktop "$pkgdir"/usr/share/applications/$pkgname.desktop
  install -Dm644 ../$pkgname.png "$pkgdir"/usr/share/pixmaps/$pkgname.png

  # install data and executable
  install -d "$pkgdir"/usr/share/$pkgname
  cp -r {resources,docs} "$pkgdir"/usr/share/$pkgname
  install -Dm755 $pkgname "$pkgdir"/usr/bin/$pkgname
}
